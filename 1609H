#include<bits/stdc++.h>
#define For(i,a,b) for(int i=(a);i<=(b);++i)
#define int long long
using namespace std;

int n,k,a[1005],m;
int t[1005],res[1005],p[1005],tmp[1005];
int f[105][55],d[1005];
pair<int,int>q[1005];

int x[1005],l[1005],r[1005],top;
void work(int T)
{
	top=0;
	For(i,0,n-1){
		x[++top]=f[i][T],l[top]=i,r[top]=i;
		while(top>=2){
			int i=top-1,j=top;
			if(p[r[i]]+1==p[l[j]] && (x[i]>0||x[j]<0)) --top,r[top]=r[top+1],x[top]+=x[top+1];
			else break; 
		}
	}
	For(i,2,top)
		if(x[i-1]>0 && x[i]<0 && p[r[i-1]]+1==p[l[i]]-1)
			(abs(x[i-1])<=abs(x[i]))?(x[i-1]=0):(x[i]=0);
	For(i,1,top)
		For(j,l[i],r[i])
			p[j]+=(x[i]>0),p[j]-=(x[i]<0);
}

signed main()
{
	cin>>n>>k;
	For(i,0,n-1)cin>>p[i];
	For(i,0,n-1)For(j,0,k-1)cin>>f[i][j];
	cin>>m;
	For(i,1,m)cin>>a[i]>>t[i],--a[i],q[i-1]=make_pair(t[i],i);
	sort(q,q+m);
	int o=0,now=0,nxt=0;
	while(o<m){
		int lst=now;
		now=min(q[o].first/k,nxt);
		For(i,0,n-1)p[i]+=(now-lst)*d[i],tmp[i]=p[i];
		For(i,0,k-1){
			while(o<m && q[o].first==now*k+i){
				int j=q[o].second;
				res[j]=p[a[j]],++o;
			}
			work(i);
		}
		if(o==m)break;
		int tim=1e18;
		For(i,1,n-1){
			int d1=tmp[i]-tmp[i-1],d2=p[i]-p[i-1];
			if(d1!=d2 && d2<=k*2+1){tim=0;break;}
			if(d1>d2) tim=min(tim,(d2-(k*2+1))/(d1-d2));
		}
		++now,nxt=now+tim;
		For(i,0,n-1) d[i]=p[i]-tmp[i];
	}
	For(i,1,m)cout<<res[i]<<"\n";
	return 0;
}